## LANP-UVAD
Official implementation of "Learning Anomalies with Normality Prior for Unsupervised Video Anomaly Detection, ECCV-2024".

## 1. Dependencies
```
python==3.7
pytorch==1.9.0
scikit-learn==0.24.2
scipy==1.7.3
tqdm==4.65.0
```
Platform: NVIDIA GeForce RTX 2080 Ti

## 2. Usage

### Setup

- Please download the extracted features for ShanghaiTech and UCF-Crime dataset from links: [**ShanghaiTech features**](https://drive.google.com/file/d/1-INdmveP1hcLPbQ7Cen1Buf0jqduIw1C/view?usp=sharing), [**UCF-Crime features**](https://drive.google.com/file/d/1R-kkyPrVnwRtgN8a80ziyq4LXJpN1xsE/view?usp=sharing). The above features use the RexNext-101 to extract from this [**repo**](https://github.com/kenshohara/video-classification-3d-cnn-pytorch)

- Please download ShanghaiTech dataset from this [**repo**](https://svip-lab.github.io/dataset/campus_dataset.html) and put the `testing` folder to `data/shanghaitech/`

<!-- 
- Please download the saved pseudo_label_scores generated by our normality propagation.  -->

- Change the file paths to the download datasets above in `config/config_sh.yaml` and `config/config_ucf.yaml`

### Train and test the LANP-UVAD

After the setup, simply run the following commands:

```shell
python main.py --load_config config/config_sh.yaml

python main.py --load_config config/config_ucf.yaml
```

## Citation

If you find this repo useful for your research, please consider citing our paper:

```bibtex
@inproceedings{park2020learning,
  title={Learning Anomalies with Normality Prior for Unsupervised Video Anomaly Detection},
  author={Shi, Haoyue and Wang, Le and Zhou, Sanping and Hua, Gang and Tang, Wei},
  booktitle={European Conference on Computer Vision},
  year={2024}
}
```